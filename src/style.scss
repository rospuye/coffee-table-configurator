@use "sass:color";

* {
    margin: 0;
    padding: 0;
}

html,
body {
    overflow: hidden;
}

.webgl {
    position: fixed;
    top: 0;
    left: 0;
    outline: none;
}

* {
    margin: 0px;
    padding: 0px;
    border: 0px;
    box-sizing: border-box;
}

html {
    width: 100%;
    height: 100%;
}

$beige-primary: #ede9e8;
$beige-secondary: color.adjust(#ede9e8, $lightness: -30%);
$grey-primary: #333;
$grey-secondary: color.adjust(#333, $lightness: 40%);
$accent1: #ffe9a0;
$accent2: #966548;

:root {
    --background: #{$accent2};
    --navbar-width: 256px;
    --navbar-width-min: 80px;
    --navbar-beige-primary: #{$beige-primary};
    --navbar-beige-secondary: #{$beige-secondary};
    --navbar-grey-primary: #{$grey-primary};
    --navbar-grey-secondary: #{$grey-secondary};
    --navbar-accent: #{$accent1};
}

html,
body {
    margin: 0;
    background: var(--background);
}

#nav-toggle:checked {
    &~#nav-header {
        width: calc(var(--navbar-width-min) - 16px);

        #nav-title {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.1s;
        }

        label[for="nav-toggle"] {
            left: calc(50% - 8px);
            transform: translate(-50%);
        }

        #nav-toggle-burger {
            background: var(--navbar-grey-primary);

            &:before,
            &::after {
                width: 16px;
                background: var(--navbar-grey-secondary);
                transform: translate(0, 0) rotate(0deg);
            }
        }
    }

    &~#nav-content,
    &~#nav-footer {
        width: var(--navbar-width-min);
    }

    &~#nav-content {
        .nav-button {
            span {
                opacity: 0;
                transition: opacity 0.1s;
            }

            .fas {
                min-width: calc(100% - 16px);
            }
        }
    }

    &~#nav-footer {
        #nav-footer-avatar {
            margin-left: 0;
            left: 50%;
            transform: translate(-50%);
        }

        #nav-footer-titlebox,
        label[for="nav-footer-toggle"] {
            opacity: 0;
            transition: opacity 0.1s;
            pointer-events: none;
        }
    }
}

#nav-bar {
    position: absolute;
    left: 2vw;
    top: 2vw;
    height: auto;
    padding-bottom: 5px;
    background: var(--navbar-beige-primary);
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    color: var(--navbar-grey-primary);
    font-family: 'Courier New', Courier, monospace;
    font-weight: bold;
    overflow: hidden;
    user-select: none;
    box-shadow: 0 0 16px rgba(0, 0, 0, 0.2);

    hr {
        margin: 0;
        position: relative;
        left: 8px;
        width: calc(100% - 32px);
        border: none;
        // border-top: solid 1px var(--navbar-beige-secondary);
    }

    a {
        color: inherit;
        text-decoration: inherit;
    }

    input[type="checkbox"] {
        display: none;
    }

    .fas {
        min-width: 3rem;
        text-align: center;
    }
}

#nav-header {
    position: relative;
    width: calc(var(--navbar-width) - 16px);
    left: 16px;
    min-height: 80px;
    background: var(--navbar-beige-primary);
    border-radius: 16px;
    z-index: 2;
    display: flex;
    align-items: center;
    transition: width 0.2s;
    margin-bottom: 5px;

    hr {
        position: absolute;
        bottom: 0;
        border-top: 2px solid #{$grey-primary};
    }
}

#nav-title {
    font-size: 1.5rem;
    transition: opacity 1s;
}

label[for="nav-toggle"] {
    position: absolute;
    right: 0;
    width: 3rem;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
}

#nav-toggle-burger {
    position: relative;
    width: 16px;
    height: 2px;
    background: var(--navbar-beige-primary);
    border-radius: 99px;
    transition: background 0.2s;

    &:before,
    &:after {
        content: "";
        position: absolute;
        top: -6px;
        width: 10px;
        height: 2px;
        background: var(--navbar-grey-primary);
        border-radius: 99px;
        transform: translate(2px, 8px) rotate(30deg);
        transition: 0.2s;
    }

    &:after {
        top: 6px;
        transform: translate(2px, -8px) rotate(-30deg);
    }
}

#nav-content {
    margin: -16px 0;
    padding: 16px 0;
    position: relative;
    flex: 1;
    width: var(--navbar-width);
    background: var(--navbar-beige-primary);
    box-shadow: 0 0 0 16px var(--navbar-beige-primary);
    direction: rtl;
    overflow: hidden;
    transition: width 0.2s;

    hr {
        border-top: 1px solid #{$beige-secondary};
    }

    &::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    &::-webkit-scrollbar-thumb {
        border-radius: 99px;
        background-color: #{$grey-primary};
    }

    &::-webkit-scrollbar-button {
        height: 16px;
    }

}

#nav-content-highlight {
    position: absolute;
    left: 16px;
    top: -54 - 16px;
    width: calc(100% - 16px);
    height: 54px;
    background: var(--background);
    background-attachment: fixed;
    border-radius: 16px 0 0 16px;
    transition: top 0.2s;

    &:before,
    &:after {
        content: "";
        position: absolute;
        right: 0;
        bottom: 100%;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        box-shadow: 16px 16px var(--background);
    }

    &:after {
        top: 100%;
        box-shadow: 16px -16px var(--background);
    }
}

.nav-button {
    position: relative;
    margin-left: 16px;
    height: 54px;
    display: flex;
    align-items: center;
    color: var(--navbar-grey-primary);
    direction: ltr;
    cursor: pointer;
    z-index: 1;
    transition: color 0.2s;

    span {
        transition: opacity 1s;
    }

    .fas {
        transition: min-width 0.2s;
    }

    .nav-option-subtext {
        font-weight: bold;
        font-size: 14px;
        color: var(--navbar-grey-secondary);
        display: inline-block;
        transition: opacity 0.15s ease;
    }

    &:hover {
        color: var(--navbar-beige-primary);

        .nav-option-subtext {
            color: var(--navbar-accent);
        }
    }

    @for $i from 1 through 3 {
        &:nth-of-type(#{$i}):hover {
            &~#nav-content-highlight {
                top: ($i - 1) * 54 + 16px;
            }
        }
    }
}

.nav-text {
    display: flex;
    flex-direction: column;
}

#top-material-button,
#base-material-button,
#top-shape-button {
    position: relative;

    &:hover .nav-dots {
        opacity: 1;
    }

    .nav-dots {
        display: flex;
        flex-direction: column;
        gap: 6px;
        align-items: center;
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: auto;

        opacity: 0;
        transition: opacity 0.2s;

    }

    .nav-dot {
        width: 5px;
        height: 5px;
        min-width: 5px;
        border-radius: 50%;
        border: none;
        background: rgba(51, 51, 51, 0.12);
        transition: transform .18s ease, background-color .22s ease, box-shadow .18s ease;
        cursor: pointer;
        padding: 0;
        outline: none;

        &:focus {
            transform: scale(1.18);
            box-shadow: 0 0 0 4px rgba(51, 51, 51, 0.25);
        }

        &.active {
            transform: scale(1.28);
            box-shadow: 0 6px 12px rgba(51, 51, 51, 0.25);
        }
    }
}


.help {
    position: fixed;
    right: 3%;
    bottom: 3%;
    display: inline-block;
    line-height: 0;

    .help-btn {
        width: 56px;
        height: 56px;
        border-radius: 50%;
        border: none;
        background: #{$grey-primary};
        color: #{$beige-primary};
        font-weight: 700;
        font-size: 1.4rem;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 6px 18px rgba(10, 10, 10, 0.4);
        cursor: default;
        -webkit-appearance: none;
        appearance: none;
        transition: transform 500ms ease, box-shadow 500ms ease;
        outline: none;
        padding: 0;
        pointer-events: none;
        user-select: none;

        // subtle lift on hover/focus
        &:hover,
        &:focus {
            transform: translateY(-3px);
            box-shadow: 0 10px 26px rgba(10, 10, 10, 0.45);
        }

        // keyboard focus ring for accessibility
        &:focus {
            box-shadow: 0 0 0 4px rgba(100, 150, 255, 0.18), 0 10px 26px rgba(10, 10, 10, 0.45);
            cursor: pointer;
        }

        // allow clicking on touch screen devices
        @media (pointer: coarse) and (hover: none) {
            .help-btn {
                pointer-events: auto;
                cursor: pointer;
            }
        }
    }

    .help-tooltip {
        position: absolute;
        right: 70px;
        bottom: 10px;
        transform: translateY(8px) scale(0.985);
        opacity: 0;
        pointer-events: none;
        transition:
            opacity 220ms cubic-bezier(.2, .9, .25, 1),
            transform 260ms cubic-bezier(.2, .9, .25, 1),
            box-shadow 200ms ease;
        transform-origin: right bottom;
        background: #{$beige-primary};
        color: #{$grey-primary};
        padding: 10px 14px;
        border-radius: 8px;
        width: min(300px, calc(100vw - 96px));
        max-width: 700px;
        font-size: 0.86rem;
        font-family: 'Courier New', Courier, monospace;
        line-height: 1.35;
        box-shadow: 0 10px 30px rgba(12, 12, 12, 0.14);
        border: 1px solid rgba(16, 16, 16, 0.06);
        will-change: opacity, transform, box-shadow;

        p {
            margin: 0;
        }

        &::after {
            content: "";
            position: absolute;
            right: -8px;
            bottom: 12px;
            width: 0;
            height: 0;
            border-left: 8px solid #{$beige-primary};
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            filter: drop-shadow(0 1px 0 rgba(12, 12, 12, 0.02));
        }
    }

    // shown state (on hover or keyboard focus)
    &:hover .help-tooltip,
    &:focus-within .help-tooltip {
        opacity: 1;
        transform: translateY(0) scale(1);
        // pointer-events: auto; // enable pointer interactions when visible
        box-shadow: 0 18px 40px rgba(12, 12, 12, 0.18);
    }

    // /* reduced motion: remove transitions and jump to final state */
    // @media (prefers-reduced-motion: reduce) {

    //     .help-btn,
    //     .help-tooltip {
    //         transition: none !important;
    //         transform: none !important;
    //     }
    // }


    // smaller screens - move tooltip above button
    @media (max-width: 480px) {
        right: 14px;
        bottom: 14px;

        .help-tooltip {
            right: 0;
            left: auto;
            bottom: 72px; // show above the button
            transform: translateY(8px);

            &::after {
                right: 18px;
                bottom: -8px;
                border-left: 8px solid transparent;
                border-right: 8px solid transparent;
                border-top: 8px solid #{$beige-primary};
                border-bottom: none;
            }
        }
    }
}

.help-list {
    list-style: none;
    padding: 0;
    margin: 0;

    li {
        display: flex;
        align-items: center;
        margin-bottom: 12px;

        .icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
            margin-right: 20px;
            vertical-align: middle;
        }

        span {
            line-height: 1.4;
            display: inline-block;
        }
    }
}

#loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: #{$grey-primary};
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    color: #{$beige-primary};
    font-size: 2rem;
    transition: opacity 0.5s ease;
}

#loading-screen.hidden {
    opacity: 0;
    pointer-events: none;
}

.loading-text {
    text-align: center;
    margin-bottom: 1rem;
    font-family: 'Courier New', Courier, monospace;
    font-weight: bold;

    h1 {
        font-size: larger;
    }

    h6 {
        font-size: medium;
    }

    a {
        color: inherit;
        text-decoration: underline;
        text-decoration-style: dotted;
        text-decoration-thickness: 1px;
    }
}

.loading-video {
    width: 75px;
    height: 75px;
    object-fit: contain;
}

.smaller {
    font-size: 0.90em;
}